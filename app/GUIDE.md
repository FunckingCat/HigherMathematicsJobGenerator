# Как пользоваться генератором шаблонов

### Структура файла с задачами
В [src/config/tasksConfiguration.ts](./src/config/tasksConfiguration.ts) хранятся все задачи.
- `section` - название раздела задач
- `section_name` - название раздела, которое будет отображаться на сайте
- `templates` - массив с самими задачами
    - `id` - уникальный идентификатор задачи
    - `name` - описане задачи, которое будет отображаться на сайте
    - `view` - пример задачи, которую будет видеть студент
    - `template` - шаблон примера, с помощью которого мы можем гибко настраивать примеры
- хранятся сами шаблоны для каждой задачи. Как настраивать эти шаблоны описано в [этом пункте](#Гибкая-настройка-шаблонов)
```js
    TASKS_CONFIGURATION = {
        section: 'proizvodnie',
        section_name: 'Задания по производным',
        templates: [{
            id: 6,
            name: 'Найти производную функции $y = f(x)$',
            view: '2sin^5 3x + \\sqrt{ln(3x - x^2)}',
            template: '[@|even]sin^[2:3] [3,5]x + \\sqrt{ln([1:7|odd]x - x^[2:8|even])}'
        }]
    }
```

### Глобальная конфигурация шаблонов
В [src/config/templatesConfig.ts](./src/config/templatesConfig.ts)
расположена базовая конфигурация `templateConfig` для всех шаблонов, у которой есть следующие поля:

- defaultSymbol: string - глобальный символ, вместо которого будет вставляться рандомное число, например, '@'
- min: integer - минимально возможное рандомное число, например, -20
- max: integer - максимально возможное рандомное число, например, 40
- aliases: { string: string[] } - объект с [псевдонимами](#Псевдонимы)

### Фильтры
В [src/config/templatesConfig.ts](./src/config/templatesConfig.ts)
есть объект `filters`, в котором хранятся функции для фильтрации чисел в шаблонах по определённым условиям.
Вы можете сами создать свои функции-фильтры под свои потребности.
Например, сейчас уже имеются следующие функции:
- odd - вставит в шаблон только нечётное число
- even - вставит в шаблон только чётное число
- withoutZero - вставит в шаблон число не равное нулю
- aboveZero - вставит в шаблон число, которое больше нуля
- lessZero - вставит в шаблон число, которое меньше нуля

### Гибкая настройка шаблонов
Шаблоны используют синтаксис KateX. Когда вам нужно вставить
динамический контент в пример, то вам нужно вставить настройку между двумя квадратными скобками `[...]`
- Вы можете вставить глобальный символ, который по умолчанию является `@`. В примере студента вместо этого символа будет рандомное число,
которое находится в диапозоне `min` и `max` включительно. Например, `[@]` означает, что в примере студента в этом месте будет рандомное число в диапозоне `min` и `max`
- Вы можете указать диапозон чисел, которые можно вставить. Например, `[10:24]` означает, что в примере студента
в этом месте будет стоять число в диапозоне от 10 до 24 включительно. Глобальные настройки при этом учитываться не будут.
- Вы можете указать нужные значения через запятую. Например, `[e,1,3]` означает, что в примере студента в этом месте будет
либо `e`, либо `1`, либо же `3`. Но с перечеслением через запятую не рекомендуется использовать фильтры, так как вы и так указываете
конкретные значения, которые хотите видеть в итоговом примере студента. Глобальные настройки при этом учитываться не будут.
- Вы можете указать фильтр, чтобы отфильтровать числа, которые попадут в итоговый пример студента. Фильтры указываются
после диапозона за символом прямой черты `|`. Например, `[1:5|even]` означает, что в примере студента в этом месте будут
только чётные числа в диапопзоне от 1 до 5 включительно, то есть 2 или 4. Напомню, что вы можете сами [создавать свои функции-фильтры любой
сложности](#Фильтры)

### Псевдонимы
Представим, что нам в шаблон нужно вставить sin, cos или tg, если
каждый раз прописывать в шаблоне `[cos,sin,tg]x`, то можно сойти с ума.
Чтобы исправить это, можно в объекте `aliases` создать поле,
значением которого является массив с теми значениями, которые мы хатим вставить
в шаблоне. Например, уже сейчас есть следующие псевдонимы:
- `trig: ['sin', 'cos', 'tg']` - псевдоним `trig` вставит в пример студента `sin`, `cos` или `tg`
- `arcs: ['arcsin', 'arccos', 'arctg']` - псевдоним `arcs` вставит в пример студента `arcsin`, `arccos` или `arctg`

Давайте рассмотрим пример.
Например, у нас есть шаблон `'[@|even]sin^[2:3] [3,5]x + \\sqrt{ln([1:7|odd]x - x^[2:8|even])}'`
- `[@|even]` - вставит любое чётное число между `min` и `max`, которые по умолчанию равны -20 и 20 соответственно.
В нашм примере получилось -2
- `[2:3]` - вставит любое число между 2 и 3, в нашем случае получилось 3
- `[3,5]` - вставит либо 3, либо 5, в нашем случае это 5
- `[1:7|odd]` - вставит любое нечётное число между 1 и 7, в нашем случае это 7
- `[2:8|even]` - вставит любое чётное число между 2 и 8, у нас получилось 8

![](./src/assets/doc/task_example.png)

### Плагины
Чтобы добавить новую функциональность в шаблон, вы можете написать свой плагин.
Плагины пишутся в папке [src/core/plugins](src/core/plugins), а подключаются 
в свойстве plugins в классе [Parser](src/core/index.ts).
Все плагны принимают в конструкторе следующие данные:
```
userHash - хэш пользователя (нужен для выбора рандомного значения для динамического токена)
serialNumber - порядковый номер примера в списке примеров у студента (нужен для выбора рандомного значения для динамического токена) 
originalTemplate - оригинальная строка шаблона, например, \int{[trig]([@|even]x)}dx
changedTemplate - массив с токенами, для данного примера массив токенов будет таким: 
  [
    '\int{', 
    { original: 'trig', value: null, index: 0 },
    '(',
    { original: '@|even, value: null, index: 1 },
    'x)}dx'
  ]
  Обычная строка, например, '\int{' попадает в массив changedTemplate как обычная строка, а динамическая
  строка, например, [trig] попадает в отдельный объект, где содержится следующая информация:
  {
    original - оригинальная строка динамического контента, например, trig
    value - значение, которое плагины назначают этому динамическому контенту, изначально все динамические токены имеют значение null
    index - индекс конкретного динамического контента среди всех других динамических токенов
  }
```
Каждый плагин должен иметь метод `init()`, который возвращает новый `changedTemplate`. 
По сути вашей главной задачей яляеется 